# 7.1 VR í…”ë ˆì˜¤í¼ë ˆì´ì…˜ ê°œìš”

VR(Virtual Reality) í—¤ë“œì…‹ì„ í™œìš©í•œ ë¡œë´‡ ì›ê²© ì œì–´ ì‹œìŠ¤í…œì˜ ì „ì²´ êµ¬ì¡°ë¥¼ ì´í•´í•©ë‹ˆë‹¤.

## 1. VR í…”ë ˆì˜¤í¼ë ˆì´ì…˜ì´ë€?

### 1.1 ê°œë…

VR í…”ë ˆì˜¤í¼ë ˆì´ì…˜ì€ ì‚¬ìš©ìê°€ VR í™˜ê²½ì—ì„œ ì§ê´€ì ìœ¼ë¡œ ë¡œë´‡ì„ ì œì–´í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

```
    VR í—¤ë“œì…‹        ë„¤íŠ¸ì›Œí¬          ë¡œë´‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‚¬ìš©ì ë™ì‘ â”‚ â†’â†’â†’ â”‚WiFi â”‚ â†’â†’â†’  â”‚XLeRobot â”‚
â”‚ - ì† ìœ„ì¹˜   â”‚     â”‚/5G  â”‚      â”‚- íŒ” ì›€ì§ì„â”‚
â”‚ - ì‹œì„  ì¶”ì  â”‚     â””â”€â”€â”€â”€â”€â”˜      â”‚- ê·¸ë¦¬í¼ â”‚
â”‚ - ì œìŠ¤ì²˜    â”‚                  â”‚- ì´ë™    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†‘                               â†“
   ì‹œê° í”¼ë“œë°±   â†â†â†â†â† ì¹´ë©”ë¼ ìŠ¤íŠ¸ë¦¼ â†â†â†â†â†
```

### 1.2 ì¥ì 

**ğŸ¯ ì§ê´€ì„±**
- ìì—°ìŠ¤ëŸ¬ìš´ 3D ê³µê°„ ì œì–´
- ì‹¤ì œ ì†ë™ì‘ê³¼ 1:1 ë§¤í•‘
- í•™ìŠµ ê³¡ì„  ìµœì†Œí™”

**ğŸ”„ ì‹¤ì‹œê°„ì„±**
- ë‚®ì€ ì§€ì—°ì‹œê°„ (<100ms)
- ë¶€ë“œëŸ¬ìš´ ë™ì‘ ì œì–´
- ì¦‰ì‹œ í”¼ë“œë°±

**ğŸ“Š ë°ì´í„° í’ˆì§ˆ**
- ì •í™•í•œ ê¶¤ì  ê¸°ë¡
- ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ë°ì´í„° ìˆ˜ì§‘
- ê³ í’ˆì§ˆ ë°ëª¨ ë°ì´í„°ì…‹

**ğŸŒ ì›ê²©ì„±**
- ì•ˆì „í•œ ê±°ë¦¬ì—ì„œ ì œì–´
- ìœ„í—˜í•œ í™˜ê²½ ì‘ì—… ê°€ëŠ¥
- ë‹¤ì¤‘ ë¡œë´‡ ë™ì‹œ ì œì–´

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 2.1 ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VR Client                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Quest 3    â”‚  â”‚  Hand Track  â”‚  â”‚   WebXR App      â”‚  â”‚
â”‚  â”‚ - 6DOF ì¶”ì   â”‚  â”‚ - ì†ê°€ë½ ì¶”ì â”‚  â”‚ - 3D ì‹œê°í™”      â”‚  â”‚
â”‚  â”‚ - ìŠ¤í…Œë ˆì˜¤   â”‚  â”‚ - ì œìŠ¤ì²˜ ì¸ì‹â”‚  â”‚ - UI ì¸í„°í˜ì´ìŠ¤  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ WebSocket/WebRTC
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   VR Server                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  WebRTC Hub  â”‚  â”‚  Data Logger â”‚  â”‚  Robot Control   â”‚  â”‚
â”‚  â”‚ - ì‹ í˜¸ ì²˜ë¦¬  â”‚  â”‚ - ê¶¤ì  ì €ì¥  â”‚  â”‚ - ëª…ë ¹ ë³€í™˜      â”‚  â”‚
â”‚  â”‚ - ì••ì¶• ì „ì†¡  â”‚  â”‚ - ë°ì´í„°ì…‹   â”‚  â”‚ - ì•ˆì „ ì²´í¬      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ Serial/Ethernet
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Hardware                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  XLeRobot    â”‚  â”‚  RGBD Camera â”‚  â”‚  Mobile Base     â”‚  â”‚
â”‚  â”‚ - ë“€ì–¼ SO100 â”‚  â”‚ - RealSense  â”‚  â”‚ - ì˜´ë‹ˆíœ         â”‚  â”‚
â”‚  â”‚ - ê·¸ë¦¬í¼ x2  â”‚  â”‚ - ìŠ¤í…Œë ˆì˜¤   â”‚  â”‚ - IMU ì„¼ì„œ      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ë°ì´í„° í”Œë¡œìš°

**Input â†’ Processing â†’ Output**

```python
# VR ì…ë ¥ ë°ì´í„°
vr_input = {
    "head_pose": {
        "position": [x, y, z],
        "orientation": [qx, qy, qz, qw]
    },
    "left_hand": {
        "position": [x, y, z],
        "orientation": [qx, qy, qz, qw],
        "fingers": [...],  # ê´€ì ˆ ê°ë„
        "grip": 0.5        # ê·¸ë¦¬í•‘ ê°•ë„
    },
    "right_hand": {...},
    "buttons": {
        "trigger": 0.8,
        "grip": True,
        "menu": False
    }
}

# ë¡œë´‡ ëª…ë ¹ìœ¼ë¡œ ë³€í™˜
robot_command = {
    "left_arm": {
        "ee_position": [x', y', z'],
        "ee_orientation": [qx', qy', qz', qw'],
        "gripper": 0.5
    },
    "right_arm": {...},
    "base": {
        "linear": [vx, vy, 0],
        "angular": [0, 0, wz]
    }
}
```

---

## 3. í•˜ë“œì›¨ì–´ ìš”êµ¬ì‚¬í•­

### 3.1 VR í—¤ë“œì…‹

**Meta Quest 3 (ê¶Œì¥)**
- í•´ìƒë„: 2064 Ã— 2208 per eye
- ë¦¬í”„ë ˆì‹œìœ¨: 72/90/120 Hz
- ì¶”ì : Inside-out 6DOF
- ì† ì¶”ì : Computer Vision ê¸°ë°˜

**ëŒ€ì•ˆ**
- HTC Vive Pro 2
- Varjo Aero
- Pico 4 Enterprise

### 3.2 ì„œë²„ í•˜ë“œì›¨ì–´

**ìµœì†Œ ì‚¬ì–‘**
```
CPU: Intel i5-10400 / AMD Ryzen 5 3600
GPU: NVIDIA RTX 3060
RAM: 16 GB DDR4
Network: WiFi 6 / Gigabit Ethernet
```

**ê¶Œì¥ ì‚¬ì–‘**
```
CPU: Intel i7-12700K / AMD Ryzen 7 5800X
GPU: NVIDIA RTX 4070 Super
RAM: 32 GB DDR4-3200
Network: WiFi 6E / 2.5G Ethernet
Storage: NVMe SSD 1TB+
```

### 3.3 ë„¤íŠ¸ì›Œí¬ ìš”êµ¬ì‚¬í•­

**ì§€ì—°ì‹œê°„**
- VR ì œì–´: < 20ms (motion-to-photon)
- ë¡œë´‡ ëª…ë ¹: < 50ms
- ë¹„ë””ì˜¤ ìŠ¤íŠ¸ë¦¼: < 100ms

**ëŒ€ì—­í­**
- ë¹„ë””ì˜¤ ì—…ìŠ¤íŠ¸ë¦¼: 50-100 Mbps
- VR ë°ì´í„°: 1-5 Mbps
- ì œì–´ ëª…ë ¹: < 1 Mbps

---

## 4. ì†Œí”„íŠ¸ì›¨ì–´ ìŠ¤íƒ

### 4.1 VR í´ë¼ì´ì–¸íŠ¸

**WebXR ê¸°ë°˜**
```javascript
// Three.js + WebXR
import * as THREE from 'three';
import { VRButton } from 'three/examples/jsm/webxr/VRButton.js';

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.xr.enabled = true;

// VR ì„¸ì…˜ ì‹œì‘
document.body.appendChild(VRButton.createButton(renderer));
```

**A-Frame ëŒ€ì•ˆ**
```html
<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
</head>
<body>
    <a-scene vr-mode-ui="enabled: true">
        <a-entity id="robot-arm" 
                  gltf-model="url(robot.glb)"
                  position="0 1 -2">
        </a-entity>
    </a-scene>
</body>
</html>
```

### 4.2 ì„œë²„ ë°±ì—”ë“œ

**Node.js + Socket.IO**
```javascript
const express = require('express');
const http = require('http');
const socketIo = require('socket.io');

const app = express();
const server = http.createServer(app);
const io = socketIo(server);

io.on('connection', (socket) => {
    socket.on('vr-input', (data) => {
        // VR ì…ë ¥ ì²˜ë¦¬
        processVRInput(data);
        
        // ë¡œë´‡ ì œì–´
        sendRobotCommand(data);
    });
});
```

**Python + FastAPI ëŒ€ì•ˆ**
```python
from fastapi import FastAPI, WebSocket
import json

app = FastAPI()

@app.websocket("/vr")
async def vr_websocket(websocket: WebSocket):
    await websocket.accept()
    
    while True:
        data = await websocket.receive_text()
        vr_input = json.loads(data)
        
        # VR ë°ì´í„° ì²˜ë¦¬
        robot_cmd = process_vr_input(vr_input)
        
        # ë¡œë´‡ ì „ì†¡
        await send_robot_command(robot_cmd)
```

### 4.3 ë¡œë´‡ ì œì–´

**ROS 2 í†µí•©**
```python
import rclpy
from geometry_msgs.msg import PoseStamped
from sensor_msgs.msg import JointState

class VRTeleopNode(Node):
    def __init__(self):
        super().__init__('vr_teleop')
        
        # Publishers
        self.arm_pub = self.create_publisher(
            PoseStamped, '/arm/target_pose', 10
        )
        
        # Subscribers
        self.joint_sub = self.create_subscription(
            JointState, '/joint_states', 
            self.joint_callback, 10
        )
    
    def vr_to_robot_pose(self, vr_pose):
        """VR ì¢Œí‘œ â†’ ë¡œë´‡ ì¢Œí‘œ"""
        robot_pose = PoseStamped()
        
        # ì¢Œí‘œê³„ ë³€í™˜
        robot_pose.pose.position.x = vr_pose['position'][0] * 0.5
        robot_pose.pose.position.y = vr_pose['position'][1] * 0.5
        robot_pose.pose.position.z = vr_pose['position'][2] * 0.5 + 0.3
        
        return robot_pose
```

---

## 5. ì œì–´ ë°©ì‹

### 5.1 ì§ì ‘ ì œì–´ (Direct Control)

**í¬ì§€ì…˜ ë§¤í•‘**
```
VR Hand Position â†’ Robot EE Position
- 1:1 ìŠ¤ì¼€ì¼ë§
- ì‹¤ì‹œê°„ ì¶”ì¢…
- ì§ê´€ì ì´ì§€ë§Œ ì •ë°€ë„ ì œí•œ
```

**ì˜ˆì‹œ ì½”ë“œ**
```javascript
function updateRobotFromVR(vrController, robotArm) {
    // VR ì»¨íŠ¸ë¡¤ëŸ¬ ìœ„ì¹˜
    const vrPos = vrController.position;
    const vrRot = vrController.rotation;
    
    // ìŠ¤ì¼€ì¼ë§ (VR ê³µê°„ â†’ ë¡œë´‡ ì‘ì—…ê³µê°„)
    const robotPos = {
        x: vrPos.x * 0.5,  // 50% ìŠ¤ì¼€ì¼
        y: vrPos.y * 0.5,
        z: (vrPos.z + 1.0) * 0.3  // ì˜¤í”„ì…‹ ì ìš©
    };
    
    // ë¡œë´‡ ëª©í‘œ ìœ„ì¹˜ ì „ì†¡
    sendRobotCommand({
        type: 'ee_position',
        position: robotPos,
        orientation: vrRot
    });
}
```

### 5.2 ìƒëŒ€ ì œì–´ (Relative Control)

**ë¸íƒ€ ì œì–´**
```
VR Hand Movement â†’ Robot EE Delta
- ìƒëŒ€ì  ì´ë™ëŸ‰
- ëˆ„ì  ì˜¤ì°¨ ë°©ì§€
- ë” ì•ˆì •ì 
```

**ì˜ˆì‹œ ì½”ë“œ**
```javascript
let lastVRPos = null;
let robotPos = { x: 0.3, y: 0, z: 0.2 };

function updateRobotRelative(vrController) {
    const currentVRPos = vrController.position;
    
    if (lastVRPos) {
        // ë¸íƒ€ ê³„ì‚°
        const delta = {
            x: currentVRPos.x - lastVRPos.x,
            y: currentVRPos.y - lastVRPos.y,
            z: currentVRPos.z - lastVRPos.z
        };
        
        // ë¡œë´‡ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
        robotPos.x += delta.x * 0.2;  // ê°ì‡  ì ìš©
        robotPos.y += delta.y * 0.2;
        robotPos.z += delta.z * 0.2;
        
        sendRobotCommand({
            type: 'ee_position',
            position: robotPos
        });
    }
    
    lastVRPos = { ...currentVRPos };
}
```

### 5.3 í´ëŸ¬ì¹˜ ì œì–´ (Clutch Control)

**ì¡°ê±´ë¶€ ì œì–´**
```
Trigger Pressed â†’ Active Control
Trigger Released â†’ Clutch (ìœ„ì¹˜ ì¬ì„¤ì •)
```

```javascript
function updateWithClutch(vrController) {
    const triggerPressed = vrController.getButton('trigger') > 0.5;
    
    if (triggerPressed) {
        // í™œì„± ì œì–´
        updateRobotFromVR(vrController);
        
        // ì‹œê°ì  í”¼ë“œë°±
        vrController.setHaptic(0.1, 100);
    } else {
        // í´ëŸ¬ì¹˜ ëª¨ë“œ (ìœ„ì¹˜ ì¬ì„¤ì • ê°€ëŠ¥)
        showClutchIndicator(true);
    }
}
```

---

## 6. ì¢Œí‘œê³„ ë³€í™˜

### 6.1 VR ì¢Œí‘œê³„

**Quest 3 ì¢Œí‘œê³„**
```
ì›ì : í—¤ë“œì…‹ ì´ˆê¸° ìœ„ì¹˜
Xì¶•: ì˜¤ë¥¸ìª½ (+1m = ì˜¤ë¥¸ìª½ 1m)
Yì¶•: ìœ„ìª½ (+1m = ìœ„ìª½ 1m)
Zì¶•: ë’¤ìª½ (+1m = ì‚¬ìš©ì ë’¤ìª½ 1m)
ë‹¨ìœ„: ë¯¸í„°
```

### 6.2 ë¡œë´‡ ì¢Œí‘œê³„

**XLeRobot ë² ì´ìŠ¤ ì¢Œí‘œê³„**
```
ì›ì : ë¡œë´‡ ë² ì´ìŠ¤ ì¤‘ì‹¬
Xì¶•: ì•ìª½ (+0.3m = ì•ìª½ 30cm)
Yì¶•: ì™¼ìª½ (+0.3m = ì™¼ìª½ 30cm)
Zì¶•: ìœ„ìª½ (+0.5m = ìœ„ìª½ 50cm)
ë‹¨ìœ„: ë¯¸í„°
```

### 6.3 ë³€í™˜ í–‰ë ¬

```python
import numpy as np

def vr_to_robot_transform():
    """VR â†’ ë¡œë´‡ ì¢Œí‘œ ë³€í™˜ í–‰ë ¬"""
    
    # ìŠ¤ì¼€ì¼ë§ (VR ê³µê°„ ì¶•ì†Œ)
    scale = 0.5
    
    # íšŒì „ (VR Zì¶•ì„ ë¡œë´‡ Xì¶•ìœ¼ë¡œ)
    rotation = np.array([
        [0, 0, -1],  # VR X â†’ ë¡œë´‡ -Z
        [1, 0, 0],   # VR Y â†’ ë¡œë´‡ X  
        [0, 1, 0]    # VR Z â†’ ë¡œë´‡ Y
    ])
    
    # í‰í–‰ì´ë™ (ë¡œë´‡ ì‘ì—…ê³µê°„ìœ¼ë¡œ)
    translation = np.array([0.3, 0.0, 0.2])
    
    return scale, rotation, translation

def transform_pose(vr_pos, vr_rot):
    """VR í¬ì¦ˆ â†’ ë¡œë´‡ í¬ì¦ˆ"""
    scale, R, t = vr_to_robot_transform()
    
    # ìœ„ì¹˜ ë³€í™˜
    robot_pos = scale * (R @ vr_pos) + t
    
    # ë°©í–¥ ë³€í™˜ (ì¿¼í„°ë‹ˆì–¸)
    robot_rot = quaternion_multiply(
        rotation_to_quaternion(R),
        vr_rot
    )
    
    return robot_pos, robot_rot
```

---

## 7. ì•ˆì „ ì‹œìŠ¤í…œ

### 7.1 ì‘ì—…ê³µê°„ ì œí•œ

```javascript
function enforceSafetyLimits(targetPos) {
    // ì‘ì—…ê³µê°„ ê²½ê³„
    const workspace = {
        x: { min: 0.1, max: 0.5 },
        y: { min: -0.3, max: 0.3 },
        z: { min: 0.1, max: 0.4 }
    };
    
    // í´ë¨í•‘
    const safePos = {
        x: Math.max(workspace.x.min, Math.min(workspace.x.max, targetPos.x)),
        y: Math.max(workspace.y.min, Math.min(workspace.y.max, targetPos.y)),
        z: Math.max(workspace.z.min, Math.min(workspace.z.max, targetPos.z))
    };
    
    // ê²½ê³  í‘œì‹œ
    if (JSON.stringify(safePos) !== JSON.stringify(targetPos)) {
        showWorkspaceWarning();
    }
    
    return safePos;
}
```

### 7.2 ë¹„ìƒ ì •ì§€

```javascript
function initEmergencyStop() {
    // ë©”ë‰´ ë²„íŠ¼ ê¸¸ê²Œ ëˆ„ë¥´ê¸°
    vrSession.addEventListener('inputsourceschange', (event) => {
        for (const inputSource of event.added) {
            inputSource.addEventListener('selectstart', (event) => {
                if (event.inputSource.profiles.includes('oculus-touch')) {
                    emergencyStopTimer = setTimeout(() => {
                        sendEmergencyStop();
                        showEmergencyNotification();
                    }, 2000); // 2ì´ˆ í™€ë“œ
                }
            });
            
            inputSource.addEventListener('selectend', () => {
                clearTimeout(emergencyStopTimer);
            });
        }
    });
}
```

### 7.3 ì¶©ëŒ ê°ì§€

```python
def check_collision(robot_pos, robot_config):
    """ì¶©ëŒ ê°ì§€"""
    
    # ìê¸° ì¶©ëŒ (íŒ”ë¼ë¦¬)
    if distance(left_arm_pos, right_arm_pos) < 0.15:
        return "self_collision"
    
    # ë² ì´ìŠ¤ ì¶©ëŒ
    if robot_pos[2] < 0.05:  # ë„ˆë¬´ ë‚®ìŒ
        return "base_collision"
    
    # ì‘ì—…ê³µê°„ ì´íƒˆ
    if not in_workspace(robot_pos):
        return "workspace_violation"
    
    return None

def handle_collision(collision_type):
    """ì¶©ëŒ ì²˜ë¦¬"""
    # ë¡œë´‡ ì •ì§€
    send_stop_command()
    
    # VR í–…í‹± í”¼ë“œë°±
    send_haptic_warning()
    
    # ì‹œê°ì  ê²½ê³ 
    show_collision_warning(collision_type)
```

---

## 8. ì„±ëŠ¥ ìµœì í™”

### 8.1 ì§€ì—°ì‹œê°„ ìµœì†Œí™”

**Motion-to-Photon Pipeline**
```
VR Input â†’ Network â†’ Robot â†’ Camera â†’ Network â†’ VR Display
   10ms      20ms     30ms     16ms     20ms       16ms
                    ì´ 112ms (ëª©í‘œ: <100ms)
```

**ìµœì í™” ë°©ë²•**
```javascript
// ì˜ˆì¸¡ ì œì–´
function predictiveControl(vrInput, latency) {
    // ì†ë„ ì¶”ì •
    const velocity = estimateVelocity(vrInput);
    
    // ë¯¸ë˜ ìœ„ì¹˜ ì˜ˆì¸¡
    const predictedPos = {
        x: vrInput.position.x + velocity.x * latency,
        y: vrInput.position.y + velocity.y * latency,
        z: vrInput.position.z + velocity.z * latency
    };
    
    return predictedPos;
}

// í”„ë ˆì„ ìŠ¤í‚µ
function adaptiveFrameRate(networkLatency) {
    if (networkLatency > 50) {
        // ê³ ì§€ì—°: 30fpsë¡œ ê°ì†Œ
        setUpdateRate(30);
    } else {
        // ì €ì§€ì—°: 90fps ìœ ì§€
        setUpdateRate(90);
    }
}
```

### 8.2 ë„¤íŠ¸ì›Œí¬ ìµœì í™”

```javascript
// ë°ì´í„° ì••ì¶•
function compressVRData(vrInput) {
    return {
        // ìœ„ì¹˜ (mm ì •ë°€ë„ë¡œ ì–‘ìí™”)
        pos: [
            Math.round(vrInput.position.x * 1000),
            Math.round(vrInput.position.y * 1000),
            Math.round(vrInput.position.z * 1000)
        ],
        // íšŒì „ (ì••ì¶•ëœ ì¿¼í„°ë‹ˆì–¸)
        rot: compressQuaternion(vrInput.rotation),
        // ë²„íŠ¼ (ë¹„íŠ¸ë§ˆìŠ¤í¬)
        btn: packButtons(vrInput.buttons)
    };
}

// ë¸íƒ€ ì••ì¶•
function deltaCompress(current, previous) {
    const threshold = 0.001; // 1mm
    
    if (distance(current.pos, previous.pos) < threshold) {
        return null; // ì „ì†¡ ìŠ¤í‚µ
    }
    
    return {
        delta_pos: subtract(current.pos, previous.pos),
        timestamp: Date.now()
    };
}
```

---

## 9. ê°œë°œ í™˜ê²½ ì„¤ì •

### 9.1 ê°œë°œ ë„êµ¬

**Meta Quest Developer Hub**
- ADB ì—°ê²°
- ì•± ë°°í¬
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

**Chrome DevTools**
- WebXR ë””ë²„ê¹…
- ë„¤íŠ¸ì›Œí¬ ë¶„ì„
- ì„±ëŠ¥ í”„ë¡œíŒŒì¼ë§

### 9.2 í…ŒìŠ¤íŠ¸ ë°©ë²•

**ì‹œë®¬ë ˆì´í„° í…ŒìŠ¤íŠ¸**
```javascript
// WebXR Emulator ì‚¬ìš©
import { WebXRManager } from 'three';

const manager = new WebXRManager(renderer, gl);
manager.enabled = true;

// ê°€ìƒ ì»¨íŠ¸ë¡¤ëŸ¬ ì‹œë®¬ë ˆì´ì…˜
const controller = manager.getController(0);
controller.position.set(0.2, 1.0, -0.3);
```

**ìœ ë‹› í…ŒìŠ¤íŠ¸**
```javascript
describe('VR Coordinate Transform', () => {
    test('VR to Robot position mapping', () => {
        const vrPos = { x: 0.1, y: 0.2, z: -0.3 };
        const robotPos = vrToRobotPos(vrPos);
        
        expect(robotPos.x).toBeCloseTo(0.25);
        expect(robotPos.y).toBeCloseTo(0.1);
        expect(robotPos.z).toBeCloseTo(0.35);
    });
});
```

---

## 10. ì°¸ê³  ìë£Œ

- [WebXR Device API](https://www.w3.org/TR/webxr/)
- [Meta Quest Developer Documentation](https://developer.oculus.com/documentation/)
- [Three.js WebXR Examples](https://threejs.org/examples/?q=webxr)
- [A-Frame VR Framework](https://aframe.io/)

---

[â† 7ì¥ ëª©ì°¨](README.md) | [ë‹¤ìŒ: 7.2 Quest3 VR ì„¤ì • â†’](02_quest3_setup.md)
