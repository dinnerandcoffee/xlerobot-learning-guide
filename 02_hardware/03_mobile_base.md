# 2.3 모바일 베이스 및 옴니휠

XLeRobot은 IKEA RÅSKOG 카트를 베이스로 3개의 옴니휠로 전방향 이동이 가능합니다.

## 1. IKEA RÅSKOG 카트

### 사양

- **모델**: RÅSKOG 유틸리티 카트
- **크기**: 35cm × 45cm × 78cm (W×D×H)
- **층수**: 3단
- **재질**: 스틸 (분체 코팅)
- **색상**: 블랙, 화이트, 베이지 등
- **가격**: $39.99 (US), ¥249 (CN)

### 장점

- ✓ 견고한 금속 프레임 (하중 ~15kg)
- ✓ 3단 선반 (배터리, 전자부품 배치)
- ✓ 캐스터 제거 후 옴니휠 장착
- ✓ 전세계 IKEA 매장에서 구매 가능

### 조립 팁

- 기본 캐스터 4개 제거
- 하단 플레이트에 옴니휠 마운트 부착
- 와셔 추가로 높이 조정 불필요

---

## 2. 옴니휠 시스템

### 3륜 옴니휠 배치

```
       전방
        ↑
        W1
       /  \
      /    \
    W2------W3
    
W1: 전방 휠 (0°)
W2: 좌후방 휠 (120°)
W3: 우후방 휠 (240°)
```

### 옴니휠 스펙

- **직경**: 100mm (4인치)
- **재질**: 알루미늄 허브 + 고무 롤러
- **베어링**: 브라스 베어링
- **하중**: ~5kg/휠
- **가격**: $9.99/개 (US), ¥135/개 (CN)

### 운동학 (Kinematics)

3륜 옴니휠은 다음 관계식을 만족:

```python
# 로봇 속도 (vx, vy, ω) → 휠 속도 (w1, w2, w3)
w1 = -vy + L*ω
w2 = 0.866*vx + 0.5*vy + L*ω
w3 = -0.866*vx + 0.5*vy + L*ω

# L: 베이스 중심에서 휠까지 거리
```

---

## 3. 모터 및 마운트

### 구동 모터

- **모델**: STS3215 서보 (베이스용 3개)
- **ID 설정**: 
  - W1 (전방): ID 13
  - W2 (좌후): ID 14  
  - W3 (우후): ID 15
- **기어비**: 직접 구동 (1:1)
- **최대 속도**: ~0.5 m/s

### 모터 마운트

**3D 프린팅 부품:**
- `drive_motor_mount.stl` (3개)
- `servo_wheel_hub.stl` (3개)
- `wheel connector.stl` (3개)

**조립:**
1. 모터 마운트를 베이스 플레이트에 M3 나사로 고정
2. 서보 모터를 마운트에 장착
3. 휠 허브를 서보 샤프트에 연결
4. 옴니휠을 허브에 M4 나사로 고정

---

## 4. 제어 시스템

### 키보드 제어 예시

```python
# 전진
vx, vy, omega = 0.1, 0.0, 0.0  # 10cm/s 전진

# 좌측 평행 이동
vx, vy, omega = 0.0, 0.1, 0.0  # 10cm/s 좌측

# 제자리 회전
vx, vy, omega = 0.0, 0.0, 0.5  # 0.5 rad/s 회전
```

### Xbox 컨트롤러 매핑

```
Left Stick:
  상하 → vx (전후 이동)
  좌우 → vy (좌우 이동)
  
Right Stick:
  좌우 → omega (회전)
```

---

## 5. 베이스 플레이트 설계

### 상단 플레이트 (base_plate_layer1.stl)

- 로봇 팔 2개 마운트
- 헤드 짐벌 마운트
- 전자부품 배선 홀

### 하단 플레이트 (base_plate_layer2.stl)

- 옴니휠 모터 마운트
- 배터리 고정 클램프
- 케이블 라우팅 채널

---

## 6. 조립 체크리스트

- [ ] IKEA 카트 기본 캐스터 제거
- [ ] 하단 플레이트 3D 프린팅 (20시간)
- [ ] 상단 플레이트 3D 프린팅 (18시간)
- [ ] 모터 마운트 3개 프린팅
- [ ] 옴니휠 3개 구매
- [ ] STS3215 서보 3개 ID 설정 (13, 14, 15)
- [ ] 모터 마운트 조립
- [ ] 휠 장착 및 정렬 확인
- [ ] 배터리 고정

---

## 참고 자료

- [Lekiwi 공식 문서](https://github.com/SIGRobotics-UIUC/LeKiwi)
- [옴니휠 운동학](https://www.hindawi.com/journals/jr/2015/347379/)
- [XLeRobot 텔레오퍼레이션](../../software/examples/4_xlerobot_teleop_keyboard.py)
